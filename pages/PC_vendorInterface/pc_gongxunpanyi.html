<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>供应商询盘</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="../../plugins/bootstrap/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="../../plugins/font-awesome/css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="../../admin/css/main.css" />
		<link rel="stylesheet" type="text/css" href="../../assets/css/style.css" />
		
		<link rel="stylesheet" type="text/css" href="../../assets/css/fenye.css" />
		<style>
			.baojia {
				color: red;
				cursor: pointer;
			}
			
			.baojia:hover {
				text-decoration: underline;
			}
			
			.scfjf {
				color: red;
				cursor: pointer;
			}
			
			.scfjf:hover {
				text-decoration: underline;
			}
			
			.tanchu {
				position: fixed;
				width: 100%;
				height: 100%;
				z-index: 3000;
				background-color: black;
				opacity: 0.5;
				display: none;
			}
			
			.tanson {
				position: absolute;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
				margin: auto;
				width: 800px;
				height: 300px;
				background-color: white;
				z-index: 4000;
				display: none;
			}
			
			.tanson h3 {
				background-color: #466686;
				color: white;
				margin-bottom: 50px;
				margin-top: 0;
				padding: 20px;
			}
			
			.bianbz,
			.biandp,
			.biandyf {
				height: 30px;
				width: 80px;
			}
			
			.feebz,
			.feedp,
			.feeyf {
				width: 77px;
				height: 30px;
			}
			
			.feeshanchu {
				color: red;
				cursor: pointer;
			}
			
			.feeshanchu:hover {
				text-decoration: underline;
			}
			
			.baofee>li {
				margin-top: 10px;
			}
			
			.xgbj {
				color: red;
				cursor: pointer;
			}
			
			.xgbj:hover {
				text-decoration: underline;
			}
			
			#feeul{
				max-height: 150px;
				overflow: auto;
			}
			
			#feeul li{
				padding:2px;
				padding-left: 15px;
				cursor: pointer;
			}
			.tableinput{
				width: 70px;
				height: 25px;
				
			}
			input.tableinput{
				border: none;
				outline: none;
			}
			select.tableinput{
				height: 25px;
			}
			
			.kaizhou>li,
			.jiezhou>li,
			.baoqi>li {
				padding-left: 15px;
				padding-bottom: 3px;
				cursor: pointer;
			}
			
			.kaizhou>li:hover,
			.jiezhou>li:hover,
			.baoqi>li:hover {
				background-color: whitesmoke;
			}
			input.fjgp20,
				input.fjgp40,
				input.fdan {
					width: 70px;
					height: 20px;
					text-align: center;
				}	
				.fjbz {
				width: 70px;
			}
			.liang{
				margin-right: 40px;
			}
			.jia20gp,.jia40gp,.jia40hq,.jia45hc{
				margin-right: 20px;
				display: inline-block;
				width: 60px;
				text-align: center;
			}
			.bao20gp,.bao40gp,.bao40hq,.bao45hc{
				width: 60px;
				margin-right: 20px;
				text-align: center;
			}
			
			.myform-group .form-group {
				margin-left: 0 !important;
				margin-right: 0 !important;
			}
			
			.myform-group .form-group label {
				padding: 0 !important;
			}
			th[rowspan='2']>span {
				margin-top: -58px;
				display: block;
			}
			
			@media only screen and (max-width:1440px) {
				th[rowspan='2']>span {
					margin-top: -80px;
					display: block;
				}
			}
		</style>
	</head>

	<body>
		
		<div class='header'>
			<div class='logo' ></div>
			<nav class='navbar navheader'>
				<div class="pull-left clickbtn"> <button class="btn btn-primary "> <i class="fa fa-bars"></i> </button> </div>
				
				<ul class="nav navbar-nav navbar-right clickul">
					<li>
						<a class="tuideng" style="cursor: pointer;">
							<i class="fa fa-envelope-o"></i> <span style="">退出登录</span>
						</a>

					</li>

				</ul>
			</nav>
		</div>
		<div class='conspage'>
			<div class='conspageson'>
				<ol class="breadcrumb">
					<li>
						<a href="#">供应商</a>
					</li>
					<li class="active">询盘管理</li>
				</ol>
			</div>
		</div>
		<div class='seider-after'>
			<div class="scroll">
				<aside class='seider'>

					<div class="panel-group" id="accordion">
						<div class="panel panel-default panelclick">
							<div class="panel-heading">

								<a data-toggle="collapse" data-parent="#accordion" data-target="#collapseOne">
									<span class='tu'><i class="fa fa-bluetooth"></i></span> &nbsp;&nbsp;
									<span class='zi'>运价管理</span>

									<i class='pull-right fa fa-angle-left '></i>
								</a>

							</div>
							<div id="collapseOne" class="panel-collapse collapse ">
								<div class="panel-body">
									<ul>
										<li>
											<a href="pc_gongyun.html">运价查询</a>
										</li>
										<li>
											<a href="pc_gonghai.html">运价管理</a>
										</li>

									</ul>
								</div>
							</div>
						</div>
						<div class="panel panel-default panelclick">
							<div class="panel-heading">

								<a data-toggle="collapse" data-parent="#accordion" data-target="#collapseTwo" class="active">
									<span class='tu'><i class="fa fa-files-o"></i></span> &nbsp;&nbsp;
									<span class='zi'>询盘管理</span>

									<i class='pull-right fa fa-angle-left '></i>
								</a>

							</div>
							<div id="collapseTwo" class="panel-collapse collapse in">
								<div class="panel-body">
									<ul>
										<li>
											<a href="pc_gongxunpan.html">未报价</a>
										</li>
										<li>
											<a href="pc_gongxunpanyi.html">已报价</a>
										</li>
										<li>
											<a href="">已过期</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
						

					</div>
				</aside>
			</div>
		</div>

		<div class='content'>

			<div style="padding: 15px;">

				<div class='contzong'>
					<div class="contson1 clearfix">

						<form class="form-horizontal myform-group" role="form">
							<div class='container-fluid' style="padding-right: 0;padding-left: 0;">

								<div class="form-group form-group-sm col-sm-5">
									<label class="col-sm-4 control-label" style="padding-right: 0;">起运港:<br>Port Of Loading:</label>
									<div class="col-sm-8">
										<select class="form-control" name="qyg">
											<option>NINGBO</option>
											<option>LAEM CHABANG</option>
											<option>BANGKOK</option>
										</select>
									</div>
								</div>
								

								<div class="form-group form-group-sm col-sm-5">
									<label class="col-sm-4 control-label" style="padding-right: 0;">开始时间:<br>Starting time:</label>
									<div class="col-sm-8">
										<input type="date" class="form-control" name="starttime">
									</div>
								</div>
								<div class="form-group form-group-sm col-sm-2">

									<button type="submit" class="col-sm-offset-3 btn btn-primary btn-sm sousuo" style="width: 70px;">search</button>

								</div>

							</div>

							<div class="container-fluid" style="padding-right: 0;padding-left: 0;">

								<div class="form-group form-group-sm col-sm-5">
									<label class="col-sm-4 control-label" style="padding-right: 0;">目的港:<br>Final Destinatton:</label>
									<div class="col-sm-8 btn-group">
										<span class="caret mycreat"></span><input type="text" class="form-control dropdown-toggle" data-toggle="dropdown" name="mdg" readonly>
										<div class="dropdown-menu mydrop" role="menu" style="width: 300px;margin-left: 13px;">

											<input class="form-control souinput" placeholder="search..." />
											<ul class="ulgang">

											</ul>
										</div>
									</div>
								</div>

								

								<div class="form-group form-group-sm col-sm-5">
									<label class="col-sm-4 control-label" style="padding-right: 0;">结束时间:<br>End Time:</label>
									<div class="col-sm-8">
										<input type="date" class="form-control" name="endtime">
									</div>
								</div>
								<div class="form-group form-group-sm col-sm-2 ">

									<button type="reset" class="col-sm-offset-3 btn btn-primary btn-sm" style="width: 70px;">reset</button>

								</div>

							</div>

							

						</form>

					</div>
					<div class="contson2">
						<a href="">共有 <span class="zongpan"></span> 个询盘</a>
						
					</div>
					<div class="contson3">
						<table class="table table-bordered tablecenter tablestrd" id='tablexunpan'>
							<thead>
								<tr>
									<th rowspan="2" class="text-center"><span>序号<br>Serial number</span></th>

									<th class="text-center">起运港<br>Port Of Loading</th>
									<th class="text-center">目的港<br>Final Destinatton</th>
									<th colspan="4" class="text-center">箱型箱量<br> Box quantity</th>
									<th rowspan="2" class="text-center"><span>报价状态<br>Quotation status</span></th>

									<th>询价时间<br>Inquiry time</th>

									<th rowspan="2"><span>操作<br>operation</span></th>
								</tr>
								<tr>

									<th>船公司<br>Suipping Line</th>
									<th>预计出货时间<br>Estimated time of shipment</th>
									<th>20GP</th>
									<th>40GP</th>
									<th>40HQ</th>
									<th>45HC</th>

									<th>备注<br>Remarks</th>
								</tr>
							</thead>
							<tbody>

								

							</tbody>
						</table>
						<div class='biaofooter clearfix'>
							<div class=" pull-left footerulleft">
								<div class="form-inline" role="form">
									<div class="form-group form-group-sm">
										每页显示:
										<select class="form-control" name="yeshu">
											<option>5</option>
											<option>10</option>
											<option>25</option>
											<option>50</option>
										</select>
										条，总共 <span class="pagezong"></span> 条
									</div>

								</div>

							</div>
							<div class="tcdPageCode pull-right" style="margin-top: -10px;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		</div>

		

		<!-- 修改报价-->
		<div class="modal fade" id="myModalcha" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header" style="background-color: #337ab7;color: white;">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
						<h4 class="modal-title text-center">Logistics solutions(物流方案)</h4>
					</div>
					<div class="modal-body">

						
						<div id="myTabContent" class="tab-content">
							<div class="tab-pane fade in active" id="home">
								<div class="mylable">
									<br />
									<label>Inquiry number(询价编号)：</label> <span class="xunbian"></span>
									<br />
									<br />
									<label>Logistics program number(物流方案编号)：</label> <span class="wwubian"></span>
									<br />
									<br />
									<label>Reply to people(回复人)：</label> <span class="huiren"></span>
									<label style="margin-left: 50px;">Reply to the phone(回复电话)：</label> <span class="huidian"></span>
									<br />
									<br />
									<label>Quotes business(报价企业)：</label> <span class="xbjqy"></span>
									<br />
									<br />
									<label>Response Time(回复时间)：</label> <span class="huitime"></span>
									<br />
									<br />
									<div style="border: 1px solid #CCCCCC;padding: 10px 15px;border-radius: 10px;background-color: whitesmoke;">
										<div>
											<div style="float: left;width: 50%;">
												<label>Port Of Loading(起运港)：</label> <span class="qiyun"></span>
											</div>
											<div style="float: left;width: 50%;">
												<label>Final Destinatton(目的港)：</label> <span class="mudigang"></span>
											</div>
										</div>
										<br />
										<br />
										<div>
											<div style="float: left;width: 50%;">
												<label>Suipping Line(船公司)：</label> <span class="chuansi"></span>
											</div>
											<div style="float: left;width: 50%;">
												<label>Transit port(中转港)：</label> <span class="zzgang"></span>
											</div>
										</div>
										<br />
										<br />
										<div class="clearfix">
											<div style="float: left;width: 50%;">
												<label>sail(开船)：</label>  <span class="kcri"></span> 
											</div>
											<div style="float: left;width: 50%;">
												<label>deadline(截关)：</label> <span class="jieguan"></span>
											</div>
										</div>
										<br />
										<div >
												<label>voyage(航程)：</label> <span class="hangcheng"></span>
											</div>
									</div>
									<br />

									<div style="border: 1px solid #CCCCCC;padding: 10px 15px;border-radius: 10px;background-color: whitesmoke;">

										<div >
											<label>Box quantity(箱型箱量)：</label><span class="myxl"></span>
										</div>
										<br />
										<div class="haiyunfei">
											<label style="color: green;">shipping fee(海运费):</label>
											<span class="haibj" ></span>
											
										</div>
										<br />
										
										<label>Valid period(有效期)：</label> <span class="youxiao"></span>
									</div>

									<br />

									<div class="feesbiao" style="border: 1px solid #CCCCCC;padding: 10px 15px;border-radius: 10px;background-color: whitesmoke;">

									</div>
									<br />
									<div style="height: 2px; width: 100%;background-color: red;"></div>
									<br />
									<label>TOTAL:</label>
									<br/>
									<br />
									<div class="mytot"></div>

									<!--<button class="btn btn-xs btn-success" style="margin-left: 150px;margin-right: 20px;" id='qrbj'>确认报价</button>-->
									
								</div>

							</div>

						</div>

					</div>
					<div class="modal-footer" style="text-align: center;">
						<button class="btn btn-sm btn-warning" id='qrxgbj' >Confirm the offer(确认报价)</button>
						<button type="button" class="btn btn-primary btn-sm" data-dismiss="modal">shut down(关闭)</button>

					</div>
				</div>
				<!-- /.modal-content -->
			</div>
			<!-- /.modal -->
		</div>
		

		<script src="../../plugins/jquery-2.1.4/jquery.min.js"></script>
		<script src='../../plugins/bootstrap/js/bootstrap.min.js'></script>
		<script type="text/javascript" src="../../plugins/jquery.slimscroll.js"></script>
		<script src='../../fenye/js/jquery.page.js'></script>
		<script>
			$('.scroll').slimScroll({
				height: '90%',

			})
		</script>
		<script src='../../admin/js/main.js'></script>
		<script src='gonglong.js'></script>
		<!--退出登录-->
		<script src="../../assets/js/tuichu.js"></script>

		<script src='../../assets/js/mohucha.js'></script>

		<script>
		
		//模糊查询船公司
		mohuchuan($('.souchuaninput'))
			$('.bcgs').on('click', function() {
				$('.souchuaninput').val('');
				$('.ulgang').empty();
				var mythis = $(this)
				setTimeout(function() {
					mythis.next().children('.souchuaninput').focus()
				}, 50)

			})
		
		//目的港
			mohucha($('.souinput'))

			
			$('.souinput').on('blur', function() {
				setTimeout(function() {
					$('.ulgang').empty();
					$('.ligang').remove()
				}, 200)

			})
			$('.bzzg').on('click', function() {
				$('.souinput').val('');
				$('.ulgang').empty();
				var mythis = $(this)
				setTimeout(function() {
					mythis.next().children('.souinput').focus()
				}, 50)

			})
			//目的港
			$('[name="mdg"]').on('click', function() {
				$('.souinput').val('');
				$('.ulgang').empty();
				var mythis = $(this)
				setTimeout(function() {
					mythis.next().children('.souinput').focus()
				}, 50)

			})
		
			
			
			
			

		
			//分页	
			function dangqian() {
				var dang = ($(this).text() - 1) * $('[name="yeshu"]').val();
				var tiao = $('[name="yeshu"]').val()
				getpan(dang, tiao,ztzpd)
			}

			function prevPage() {
				var dang = ($('.current').text() - 1) * $('[name="yeshu"]').val()
				var tiao = $('[name="yeshu"]').val()
				getpan(dang, tiao,ztzpd)
			}

			function nextPage() {
				var dang = ($('.current').text() - 1) * $('[name="yeshu"]').val()
				var tiao = $('[name="yeshu"]').val()
				getpan(dang, tiao,ztzpd)
			}
			$(document).on('click', '.tcdNumber', dangqian)
			$(document).on('click', '.prevPage', prevPage)
			$(document).on('click', '.nextPage', nextPage)

			$('[name="yeshu"]').on('change', function() {
				
					getpan(0, $('[name="yeshu"]').val(),ztzpd)
					creatfenye()
				
			})

			
			function creattable(a, i) {
				//console.log(a.schemeStatus)
				var zhuang = '';
				var baotai = '';
				var xuntai = '';
				var zhuangang = '';
				var bao = '';
				var beizhu = a.elements.remark;
				if(!beizhu) {
					beizhu = ''
				}
				var ludan = '';
				var cgs = '';
				var gxbj = ''
				cgs = a.carryCode;
				if(!cgs) {
					cgs = ''
				}

				if(a.schemeStatus == 5) {
					baotai = '未报价';
					
				}
				if(a.schemeStatus == 3) {
					baotai = '已报价'
					bao = '<span class="xgbj" data-enqury=' + a.enquiryCode + ' data-schemecode=' + a.schemeCode + ' data-toggle="modal" data-target="#myModalcha">修改报价<span>'
				}

				var gp20 = null;
				var gp40 = null;
				var hq40 = null;
				var hc45 = null;
				gp20 = +(a.elements.num20gp);
				gp40 = +(a.elements.num40gp);
				hq40 = +(a.elements.num40hq);
				hc45 = +(a.elements.num45hc);
				if(!gp20) {
					gp20 = '--'
				};
				if(!gp40) {
					gp40 = '--'
				};
				if(!hq40) {
					hq40 = '--'
				};
				if(!hc45) {
					hc45 = '--'
				};

				$('#tablexunpan>tbody').append(
					'<tr><td rowspan="2">' +
					i + '</td><td>' +
					a.polName + '</td><td>' +
					a.podName + '</td><td rowspan="2">' +
					gp20 + '</td><td rowspan="2">' +
					gp40 + '</td><td rowspan="2">' +
					hq40 + '</td><td rowspan="2">' +
					hc45 + '</td><td rowspan="2">' +
					baotai + '</td><td>' +
					a.enquiryTime + '</td><td rowspan="2">' + bao + '</td></tr><tr><td>' +
					cgs + '</td><td>' +
					a.expectTime + '</td><td>' +
					beizhu + '</td></tr>'
				)
			}

		
			
			
			
			var ztzpd=5;
			
			var pagenum=0;
			function creatfenye(pagezong,pagedang){
						var yeshu = Math.ceil(pagenum / $('[name="yeshu"]').val())
								$(".tcdPageCode").createPage({
									pageCount: yeshu,
									current: 1,
									backFn: function(p) {
										//console.log(p);
									}
								});
								
			}
			

			//获取询盘列表
			function getpan(dqys, yc) {
				var qiyug = $('[name="qyg"]').val();
				if(qiyug=='NINGBO'){
							qiyug='CNNGB'
						}
						if(qiyug=='LAEM CHABANG'){
							qiyug='THLCB'
						}
						if(qiyug=='BANGKOK'){
							qiyug='THBKK'
						}
				$('#tablexunpan>tbody').empty()
				var g = new Date().getTime();
				$.ajax({
					type: "post",
					url: "http://106.14.251.28:8085/bizCenter/enquiryService/getEnquirys",
					data: {
						'accessToken': localStorage.accessToken,
						'msgId': g + '',
						"isBackward": 1,
						"enquiryStatus": 0,
						"polCode": qiyug,
						"podCode": $('[name="mdg"]').attr('data-code'),
						"schemeStatus": 3,
						"enquiryTimeStart": $('[name="starttime"]').val(),
						"enquiryTimeEnd": $('[name="endtime"]').val(),
						"currentPage": dqys, //当前页数
						"pageSize": yc //页长
					},
					async: true,
					dataType: 'json',
					success: function(json) {
						console.log(json)
						if(json.retCode == '0000') {
							var num=json.num
							
							$('.pagezong').text(num)
							if(+num!=pagenum){
								pagenum=num;
								$('.pagezong').text(pagenum)
								creatfenye()//分页函数
							}
							
							$('.zongpan').text(num)
							var a = json.enquirys;
							//console.log(a)
							
							for(var i = 0; i < a.length; i++) {
								creattable(a[i], i + 1)
							}

						} else {
							alert('数据报错')
						}

					},
					error: function(data) {
						console.log('ajax请求错误')
					}
				})
			}

			
				getpan(0, $('[name="yeshu"]').val()) 
			

			function numb(a) {
				var str = a;
				var shuzhu = str.split('-');

				var newstr = '';
				for(var i = 0; i < shuzhu.length; i++) {
					newstr += shuzhu[i]
				}
				return +newstr;
			}

			//搜索
			$('.sousuo').on('click', function(e) {
				e.preventDefault();
				
				var blur = numb($('[name="starttime"]').val()) > numb($('[name="endtime"]').val());
				if(blur) {
					error('搜索错误', '开始时间不能大于结束时间')
				} else {
					//getpanzong('', '', 5) //5代表未报价
					getpan(0, $('[name="yeshu"]').val()) //5代表未报价
				}

			})

			

			
			
			
			
			//修改报价

			$(document).on('click', '.xgbj', function() {
				$('#haiyun').empty()
				var thisschemecode = $(this).data('schemecode')
				var thisstatus = $(this).data('mystatus')
				$('#qrbj').attr('data-schemecode', this.dataset.schemecode)
				$('#xgbj').attr('data-schemecode', this.dataset.schemecode)
				var t = new Date().getTime();
				$.ajax({
					type: "post",
					url: "http://106.14.251.28:8085/bizCenter/schemeService/getSchemeInfo",
					data: {
						'accessToken': localStorage.accessToken,
						'msgId': t + '',

						"schemeCode": thisschemecode,
					},
					async: true,
					dataType: 'json',
					success: function(data) {
						console.log(data)

						var a = data.schemes

						
						
						var scode = a.schemeCode
							//alert(scode)
							//console.log(scode)
							
						$('.huiren').text(a.replyName)
						$('.huidian').text(a.replyMobileNo)
						$('.huitime').text(a.replyTime) //回复时间
						$('.xunbian').text(a.enquiryCode); //询价编号
						$('.xbjqy').text(a.supplierComanyName)
						$('.wwubian').text(a.schemeCode);
						$('.qiyun').text(a.polName);
						$('.mudigang').text(a.podName);
						$('.chuansi').text(a.carryCode);
						$('.zzgang').text(a.potName);
						$('.hangcheng').text(a.sailingDay);
						$('.kcri').text(a.etd);
						$('.jieguan').text(a.customsClearance);
						$('.youxiao').text(a.expireDate);
						
						
						
					
						var rmbzong = 0;
						var meizong = 0;
						
						$('.myxl').empty();
						if(a.num20gp>0){
							$('.myxl').append('<span class="liang">20GP * <span class="liang20gp">'+a.num20gp+'</span></span>')
						}
						if(a.num40gp>0){
							$('.myxl').append('<span class="liang">40GP * <span class="liang40gp">'+a.num40gp+'</span></span>')
						}
						if(a.num40hq>0){
							$('.myxl').append('<span class="liang">40HQ * <span class="liang40hq">'+a.num40hq+'</span></span>')
						}
						if(a.num45hc>0){
							$('.myxl').append('<span class="liang">45HC * <span class="liang45hc">'+a.num45hc+'</span></span>')
						}
						
						$('.haicb').empty()
						$('.haibj').empty()
						$('.feesbiao').empty();
						for(var i = 0; i < a.primeFeesLists.length; i++) {
							var bizhong = null;
							var c20gp = a.primeFeesLists[i].cost20gp;
							var c40gp = a.primeFeesLists[i].cost40gp;
							var c40hq = a.primeFeesLists[i].cost40hq;
							var c45hc =a.primeFeesLists[i].cost45hc;
							if(c20gp == undefined) {
								c20gp = 0;
							}
							if(c40gp == undefined) {
								c40gp = 0;
							}
							var jizong = (c20gp * a.num20gp) + (c40gp * a.num40gp) 

							if(a.primeFeesLists[i].currency == 0) {
								bizhong = '￥';
							};
							if(a.primeFeesLists[i].currency == 1) {
								bizhong = '$ ';
							};
							if(a.primeFeesLists[i].currency == 2) {
								bizhong = 'B'
							};

							if(a.primeFeesLists[i].byOrder == 1) {

								$('.feesbiao').append('<div class="feetable" data-typenum=' + a.primeFeesLists[i].feeTypeNum + ' data-focde=' + a.primeFeesLists[i].feeCode + ' data-order=' +
									a.primeFeesLists[i].byOrder + ' data-currency='+a.primeFeesLists[i].currency+'><label>' +
									a.primeFeesLists[i].feeTypeEname+' ('+ a.primeFeesLists[i].feeTypeCname +')'+
									': </label> <span>' + bizhong + '</span> <input  class="kegai" style="width: 80px;text-align: center;" value=' + a.primeFeesLists[i].orderPrice + ' /></div><br />')
							} else if(+a.primeFeesLists[i].feeTypeNum == 0) {
								
										$('.haibj').attr('data-currency',a.primeFeesLists[i].currency)
										$('.haibj').attr('data-typenum',a.primeFeesLists[i].feeTypeNum)
										$('.haibj').attr('data-focde',a.primeFeesLists[i].feeCode)
										if(a.num20gp>0){
											//$('.haicb').append('<span>'+bizhong+'</span> <span class="jia20gp">'+a.primeFeesLists[i].cost20gp+'</span>');
											$('.haibj').append('<span>'+bizhong+'</span> <input class="bao20gp" value='+a.primeFeesLists[i].cost20gp+'>')
										}
										if(a.num40gp>0){
											//$('.haicb').append('<span>'+bizhong+'</span> <span class="jia40gp">'+a.primeFeesLists[i].cost40gp+'</span>');
											$('.haibj').append('<span>'+bizhong+'</span> <input class="bao40gp" value='+a.primeFeesLists[i].cost40gp+'>')
										}
										if(a.num40hq>0){
											//$('.haicb').append('<span>'+bizhong+'</span> <span class="jia40hq">'+a.primeFeesLists[i].cost40hq+'</span>');
											$('.haibj').append('<span>'+bizhong+'</span> <input class="bao40hq" value='+a.primeFeesLists[i].cost40hq+'>')
										}
										if(a.num45hc>0){
											//$('.haicb').append('<span>'+bizhong+'</span> <span class="jia45hc">'+a.primeFeesLists[i].cost45hc+'</span>');
											$('.haibj').append('<span>'+bizhong+'</span> <input class="bao45hc" value='+a.primeFeesLists[i].cost45hc+'>')
										}
								
							} else {
								$('.feesbiao').append(
									'<div class="feetable" data-typenum=' + a.primeFeesLists[i].feeTypeNum + ' data-focde=' + a.primeFeesLists[i].feeCode + ' data-order=' +
									a.primeFeesLists[i].byOrder + ' data-currency='+a.primeFeesLists[i].currency+'><label>' +
									a.primeFeesLists[i].feeTypeEname+' ('+ a.primeFeesLists[i].feeTypeCname +')'+
									': </label> <span>' +
									bizhong + '' + ' <input  class="kegai" style="width: 60px;text-align: center;margin-right: 50px;" value=' + c20gp + '>' + bizhong + '' + ' <input class="kegai"  style="width: 60px;text-align: center;" value=' + c40gp + '>' +
									'</span></div><br />'
								)
							}

						}

						var tot = eval('(' + a.primeTotal + ')');
						
						
						if(tot['0']>0){
							$('.mytot').append('<span class="totmoney"><span>￥</span><span>'+tot['0']+'</span></span>')
						}
						if(tot['1']>0){
							$('.mytot').append('<span class="totmoney"><span>$</span><span>'+tot['1']+'</span></span>')
						}
						if(tot['2']>0){
							$('.mytot').append('<span class="totmoney"><span>B</span><span>'+tot['2']+'</span></span>')
						}
					}
				})
			})

			

			//  修改报价  确认运价方案及前向提交

			$('#qrxgbj').on('click', function() {
				var feearr = [{
					'feeCode': $('.haibj').data('focde'),
					'cost20gp': $('.bao20gp').val(),
					'cost40gp': $('.bao40gp').val(),
					'cost40hq': $('.bao40hq').val(),
					'cost45hc': $('.bao45hc').val(),
					'currency': $('.haibj').data('currency'),
					'orderPrice': '',
				}];

				for(var i = 0; i < $('.feetable').length; i++) {
					if($('.feetable').eq(i).data('order') == 1) {
						feearr.push({
							'feeCode': $('.feetable').eq(i).data('focde'),
							'cost20gp': '',
							'cost40gp': '',
							'cost40hq': '',
							'cost45hc': '',
							'currency': $('.feetable').eq(i).data('currency'),
							'orderPrice': $('.feetable').eq(i).find('.kegai').val(),
						})
					} else {
						feearr.push({
							'feeCode': $('.feetable').eq(i).data('focde'),
							'cost20gp': $('.feetable').eq(i).find('.kegai').eq(0).val(),
							'cost40gp': $('.feetable').eq(i).find('.kegai').eq(1).val(),
							'cost40hq': '',
							'cost45hc': '',
							'currency': $('.feetable').eq(i).data('currency'),
							'orderPrice': ''
						})
					}

				}

				console.log(feearr)

				var thisschemecode = $(this).data('schemecode')
				var m = new Date().getTime();
				$.ajax({
					type: "post",
					url: "http://106.14.251.28:8085/bizCenter/feeService/batchUpdateFee",
					data: {
						'accessToken': localStorage.accessToken,
						'msgId': m + '',
						"schemeCode": $('.wwubian').text(),
						'fees': JSON.stringify(feearr)
					},
					async: true,
					dataType: 'json',
					success: function(data) {

						console.log(data)
						if(data.retCode == '0000') {
							alert('修改报价成功')
							/*var mt = new Date().getTime();
							$.ajax({
								type: "post",
								url: "http://106.14.251.28:8085/bizCenter/schemeService/forwardScheme",
								data: {
									'accessToken': localStorage.accessToken,
									'msgId': mt + '',
									"schemeCode": $('.wwubian').text(),
								},
								async: true,
								dataType: 'json',
								success: function(data) {
									if(data.retCode = '0000') {
										alert('确认报价成功')
										location='pc_haixunpan.html'
									} else {
										alert('报价失败')
									}
								}
							})*/

						} else {
							//alert('修改失败')
						}

					}
				})

			})
		
		
		</script>

	</body>

</html>